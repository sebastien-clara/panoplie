declare name "cabinetMarshallGreenTreble";
declare description "Generated by tools/physicalModeling/ir2dsp.py";

import("stdfaust.lib");

pi = 4*atan(1.0);
nModes = 150;

modeFrequencies=(72.2131250787,122.206827056,161.090817483,177.755384809,227.749086787,333.291346517,472.162740899,583.259856405,633.253558383,716.576395012,877.667212495,944.325481799,1049.86774153,1166.51971281,1188.73913591,1349.82995339,1438.7076458,1472.03678045,1610.90817483,1688.67615569,1755.33442499,1788.66355964,1871.98639627,1966.41894445,2094.18062728,2116.40005038,2216.38745434,2266.38115632,2349.70399295,2399.69769492,2566.34336818,2699.65990679,2832.9764454,3021.84154176,3082.94495528,3199.59692657,3327.3586094,3460.675148,3616.21110971,3743.97279254,3971.72187933,4043.93500441,4066.15442751,4105.03841794,4210.58067767,4366.11663938,4488.32346643,4582.75601461,4660.52399547,4721.62740899,4777.17596675,4910.49250535,4938.26678423,5110.46731326,5238.2289961,5377.10039048,5504.86207331,5565.96548684,5654.84317924,5704.83688122,5788.15971785,5943.69567956,6104.78649704,6238.10303565,6415.85842046,6560.28467061,6704.71092077,6860.24688248,6993.56342109,7082.44111349,7254.64164252,7310.19020028,7376.84846958,7410.17760423,7437.95188311,7499.05529664,7571.26842172,7637.92669102,7726.80438342,8160.0831339,8243.40597053,8337.83851871,8387.83222068,8482.26476886,8521.14875929,8621.13616324,8660.02015367,8760.00755763,8782.22698073,8815.55611538,8915.54351933,9182.17659655,9226.61544275,9287.71885628,9382.15140446,9498.80337574,9537.68736617,9548.79707772,9582.12621237,9643.2296259,9698.77818365,9709.8878952,9732.1073183,9776.5461645,9848.75928958,9920.97241466,9987.63068397,9998.74039552,10115.3923668,10170.9409245,10226.4894823,10259.818617,10270.9283285,10337.5865978,10393.1351556,10504.2322711,10548.6711173,10576.4453961,10643.1036654,10654.213377,10670.8779443,10759.7556367,10787.5299156,10876.407608,10943.0658773,10954.1755889,11015.2790024,11165.2601083,11309.6863585,11437.4480413,11476.3320317,11520.7708779,11654.0874166,11676.3068397,11698.5262628,11781.8490994,11854.0622245,11909.6107822,11998.4884746,12065.1467439,12548.4191964,12581.748331,12720.6197254,12765.0585716,12826.1619851,12859.4911198,12937.2591006,13015.0270815,13137.2339086,13148.3436201);
massEigenValues=(0.115307565694,0.462694806576,0.554754815935,0.55315376911,0.63804764665,0.844633992123,0.882573888295,0.45478668925,0.846511780094,0.902926830497,0.631199358527,0.360372988836,0.341697677072,0.76666431885,0.758326538406,0.475635948798,0.475112530036,0.488844233474,0.600784584788,0.861129968907,0.705983381317,0.70499855834,0.462181850853,0.660381492759,1.0,0.976791765126,0.975594435256,0.913152845988,0.846197786698,0.843359492389,0.516751356863,0.611978626182,0.457445798506,0.51764896159,0.623111433834,0.741130123506,0.69553426424,0.687875497532,0.529639149371,0.330528416024,0.419704179501,0.327913569092,0.339823051093,0.289278481695,0.377248095079,0.502822582103,0.642020416833,0.471230239326,0.438130370727,0.382266576511,0.382516438133,0.237520856541,0.248396320954,0.275118379395,0.198063460734,0.208715908564,0.255751759893,0.22186127261,0.269571074609,0.274668862714,0.277752238392,0.17212698914,0.0880321898095,0.0645439983154,0.0530226176584,0.0608883056823,0.0811994801867,0.0855933503506,0.0831356756783,0.0635774411394,0.0395305395718,0.039855602567,0.0218937570646,0.0211091549516,0.0215203683309,0.0146885141939,0.0138612216308,0.0156148122945,0.0140609094506,0.0119413421719,0.0145450720129,0.0166028108017,0.0154839784018,0.0218519591648,0.0194908195625,0.0196776400044,0.0173277623621,0.0167560669878,0.0161638043327,0.014805825717,0.0162824122852,0.0107869581603,0.0154515060558,0.0173517188486,0.0223006850345,0.0174030944746,0.0182851484074,0.0183893494613,0.018547070392,0.0179684771841,0.0215250663474,0.0214048058867,0.0219721856284,0.0218470253491,0.0246288368218,0.0194354672586,0.0207858111971,0.0206031650755,0.0218534503956,0.0232001134213,0.0215202551565,0.0225394446324,0.0222784446769,0.0147397909705,0.0164871787208,0.0155682919688,0.0145139417232,0.0135602552956,0.0223057737166,0.0226963797045,0.0229934203822,0.0275470641455,0.0264877949376,0.0340833263859,0.0390613376374,0.0392485532588,0.0432775104486,0.0325085054339,0.0197875485715,0.0147989108952,0.0164114369582,0.0172901349573,0.024845171164,0.0245496046871,0.0253848462007,0.0326371441067,0.0278608057851,0.0297769978636,0.022337159031,0.0193186989475,0.010815583585,0.0118897892068,0.0154821824784,0.0135763230617,0.0160042085714,0.0157935046079,0.0153330540041,0.0148935554862,0.0137236757158,0.0135194448394);
t60=(4.07275290229,0.0783990353539,0.162985339515,0.160841826757,0.174621551698,0.643132225291,0.763704826809,0.0783990353539,0.407345805406,0.718785622302,0.872794323539,0.0683354901278,0.0683354901278,0.452597744427,0.452597744427,0.0384998560076,0.0384998560076,0.0384998560076,0.0620988023873,0.349164741141,0.21825734818,0.214429646696,0.0382597222295,0.118699950961,0.174621551698,0.169773129941,0.169773129941,0.167448544174,0.160841826757,0.160841826757,0.038621059178,0.330295206849,0.0382597222295,0.0892610221477,0.156719686852,0.305528943153,0.165186785054,0.678857440537,0.0905822463244,0.0252183924559,0.359431987757,0.0617855680864,0.0657666751259,0.0602656873902,0.0947917280661,0.131454958861,0.26568756262,0.127349440656,0.124752072014,0.0970468076064,0.0970468076064,0.0138997864465,0.0139154389333,0.718785622302,0.814613258605,0.107254010001,0.154736885385,0.1328829652,0.160841826757,0.162985339515,0.230607102062,0.0955316760376,0.0112467396312,0.872794323539,0.0664806780444,0.581888999203,0.135834178312,0.142148401762,0.137359524421,0.115342736679,0.00937690844301,0.00937690844301,0.0092101260271,0.00920330651023,0.0092101260271,0.00914911490185,0.488799295711,0.939926321566,1.01824698596,0.0886147711953,0.10450591701,0.106322048027,0.105406154366,0.610979531587,0.509162668329,0.452597744427,0.10820246688,0.106322048027,0.105406154366,0.10450591701,0.678857440537,0.0225380381034,0.0551145245097,0.0556148527445,0.070296900655,0.0556148527445,0.05612436132,0.05612436132,0.05612436132,0.0558684437699,0.0643837642314,0.0643837642314,0.0694989631848,0.0694989631848,0.210733934924,0.0617855680864,0.0620988023873,0.0620988023873,0.0694989631848,0.0815318609316,0.0643837642314,0.0809924340054,0.070296900655,0.0546231307137,0.055363556662,0.0404019058763,0.0402692629172,0.0400065778447,0.0886147711953,0.089916776793,0.0912576482394,0.101895228693,0.094063163912,0.128689136067,0.179755174754,0.179755174754,0.197143252978,0.118699950961,0.0849257553911,0.0402692629172,0.0406698358435,0.0409413501626,0.131454958861,0.131454958861,0.149078647077,0.197143252978,0.15875398966,0.165186785054,0.106322048027,0.0970468076064,0.0728047041805,0.0933457228774,0.119862907549,0.0986108143979,0.121048892983,0.121048892983,0.118699950961,0.101895228693,0.0994118910513,0.0986108143979);

modeFreqs=par(i,nModes,ba.take(i+1, modeFrequencies));
modeGains=par(i,nModes,ba.take(i+1, massEigenValues));
modeT60 = par(i,nModes,ba.take(i+1,t60));

cabinetMarshallGreenTreble=modalModel(nModes,modeFrequencies,modeT60,modeGains);

modalModel(n,modeFreqs,modeRes,modeGains) = _ <: par(i,n,gain(i)*pm.modeFilter(freqs(i),res(i))) :> _
with {
	freqs(i) = ba.take(i+1,modeFreqs);
	res(i) = ba.take(i+1,modeRes);
	gain(i) = ba.take(i+1,modeGains);
};


cab = cabinetMarshallGreenTreble;

wetdry = vslider("[2] amount[style:knob]",  1, 0, 1, 0.01);
dry = 1 - wetdry;

process = _ <: _*dry, (_*wetdry:cab) :> _;
