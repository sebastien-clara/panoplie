declare name "cabinetCarvinKirbyTreble";
declare description "Generated by tools/physicalModeling/ir2dsp.py";

import("stdfaust.lib");

pi = 4*atan(1.0);
nModes = 67;

modeFrequencies=(148.818897638,396.850393701,694.488188976,942.519685039,1091.33858268,1537.79527559,1637.00787402,1736.22047244,1934.64566929,2281.88976378,2579.52755906,3075.59055118,3422.83464567,3522.04724409,3621.25984252,3720.47244094,3819.68503937,4216.53543307,4464.56692913,4662.99212598,4911.02362205,5109.4488189,5208.66141732,5307.87401575,5555.90551181,5655.11811024,5754.33070866,5853.54330709,5952.75590551,6051.96850394,6200.78740157,6300.0,6399.21259843,6498.42519685,6597.63779528,6696.8503937,6796.06299213,6895.27559055,7242.51968504,7341.73228346,7887.4015748,7986.61417323,8085.82677165,8333.85826772,8433.07086614,8730.70866142,8829.92125984,9325.98425197,9772.44094488,9871.65354331,9970.86614173,10268.503937,10714.9606299,11955.1181102,12401.5748031,12996.8503937,13096.0629921,13393.7007874,14633.8582677,15874.015748,15973.2283465,16122.0472441,16568.503937,16667.7165354,16766.9291339,17064.5669291,17411.8110236);
massEigenValues=(1.0,0.276016517396,0.20803800039,0.184929059217,0.308126795084,0.286297087214,0.313111292451,0.280467529825,0.345398566643,0.741542507174,0.555447079797,0.620770344677,0.556682431558,0.663281149561,0.608492000945,0.576259022371,0.601006781274,0.345947424572,0.45305523507,0.56822079312,0.361784079739,0.36424681916,0.387719487741,0.379403618668,0.361990398422,0.382658552769,0.386338388343,0.334335848252,0.286179981728,0.243570415023,0.221386312498,0.212977731227,0.229132753773,0.254726354842,0.278356016008,0.290255291153,0.246948565901,0.215497291124,0.0783550794599,0.0620875417708,0.152350359351,0.155824781398,0.150518466222,0.109112658948,0.100151406539,0.080837685954,0.08003952179,0.130365232279,0.088467533478,0.0884344407417,0.0924111555314,0.0625993862824,0.0832536565264,0.023086159018,0.0202186046944,0.0177530763255,0.0170209136933,0.0151360067067,0.0139668278323,0.011132859585,0.0117233560443,0.0112354858442,0.0167674365084,0.0172041934353,0.0185247871872,0.0151836839638,0.0223499027846);
t60=(54.5551345459,12.1234241675,6.81946037017,6.81946037017,21.8221008255,4.36448284128,4.36448284128,4.1966211299,5.74271583995,18.1850970787,9.09258771183,15.5872372595,7.79365780231,8.39316391442,8.39316391442,7.79365780231,8.39316391442,1.73198489194,7.27408583852,12.1234241675,1.73198489194,1.73198489194,1.78876871308,1.73198489194,1.73198489194,1.73198489194,1.73198489194,1.73198489194,1.53684049253,1.29900825581,1.28372672748,1.28372672748,1.28372672748,1.29900825581,9.09258771183,9.09258771183,1.29900825581,1.28372672748,1.18605782904,0.491565341642,9.09258771183,9.09258771183,9.09258771183,4.1966211299,1.98389857122,1.84940228482,1.84940228482,9.09258771183,1.94847321007,1.94847321007,1.98389857122,0.491565341642,8.39316391442,6.81946037017,3.30644538782,3.030914801,2.94900030222,2.87139709284,15.5872372595,2.53752281998,2.59793816459,2.53752281998,4.04119361938,4.04119361938,4.36448284128,2.94900030222,10.9110895852);

modeFreqs=par(i,nModes,ba.take(i+1, modeFrequencies));
modeGains=par(i,nModes,ba.take(i+1, massEigenValues));
modeT60 = par(i,nModes,ba.take(i+1,t60));

cabinetCarvinKirbyTreble=modalModel(nModes,modeFrequencies,modeT60,modeGains);

modalModel(n,modeFreqs,modeRes,modeGains) = _ <: par(i,n,gain(i)*pm.modeFilter(freqs(i),res(i))) :> _
with {
	freqs(i) = ba.take(i+1,modeFreqs);
	res(i) = ba.take(i+1,modeRes);
	gain(i) = ba.take(i+1,modeGains);
};


cab = cabinetCarvinKirbyTreble;

wetdry = vslider("[2] amount[style:knob]",  1, 0, 1, 0.01);
dry = 1 - wetdry;

process = _ <: _*dry, (_*wetdry:cab) :> _;
