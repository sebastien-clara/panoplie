declare name "cabinetFenderBlackfaceTreble";
declare description "Generated by tools/physicalModeling/ir2dsp.py";

import("stdfaust.lib");

pi = 4*atan(1.0);
nModes = 264;

modeFrequencies=(105.54225973,133.316538607,177.755384809,238.858798337,272.187932989,305.517067641,333.291346517,433.278750472,605.479279506,716.576395012,755.460385439,849.892933619,877.667212495,910.996347147,988.764328001,999.874039552,1022.09346265,1105.41629928,1133.19057816,1144.30028971,1255.39740521,1272.06197254,1283.17168409,1344.27509762,1377.60423227,1388.71394382,1405.37851115,1472.03678045,1594.24360751,1616.46303061,1710.89557879,1833.10240584,1871.98639627,1899.76067515,1933.0898098,2038.63206953,2166.39375236,2283.04572364,2316.37485829,2366.36856027,2449.6913969,2610.78221438,2727.43418567,2855.1958685,2882.97014737,2999.62211865,3127.38380149,3160.71293614,3227.37120544,3294.02947474,3405.12659025,3449.56543645,3555.10769618,3577.32711928,3727.30822522,3749.52764832,3832.85048495,3888.3990427,3955.057312,3999.49615821,4132.81269681,4255.01952387,4410.55548558,4443.88462023,4554.98173573,4688.29827434,4821.61481295,4960.48620733,5110.46731326,5249.33870765,5382.65524625,5510.41692908,5649.28832347,5782.60486207,5915.92140068,6060.34765084,6182.55447789,6315.8710165,6404.74870891,6471.40697821,6626.94293992,6654.71721879,6710.26577655,6799.14346895,6915.79544023,6999.11827686,7032.44741151,7115.77024814,7149.09938279,7187.98337322,7260.1964983,7332.40962338,7393.51303691,7449.06159466,7515.71986396,7571.26842172,7649.03640257,7776.7980854,7799.0175085,7893.45005668,7904.55976823,7948.99861444,7971.21803754,8004.54717219,8076.76029727,8143.41856657,8171.19284545,8232.29625897,8371.16765336,8448.93563421,8537.81332662,8582.25217282,8676.684721,8754.45270185,8810.0012596,8848.88525003,8987.75664441,9048.86005794,9115.51832725,9198.84116387,9254.38972163,9309.93827938,9376.59654868,9487.69366419,9609.90049125,9737.66217408,9754.3267414,9804.32044338,9915.41755889,10059.843809,10109.837511,10209.824915,10248.7089054,10337.5865978,10387.5802998,10409.7997229,10465.3482806,10543.1162615,10626.4390981,10687.5425117,10715.3167905,10776.4202041,10820.8590503,10931.9561658,11081.9372717,11131.9309737,11143.0406852,11226.3635219,11293.0217912,11326.3509258,11448.5577529,11504.1063106,11565.2097241,11620.7582819,11731.8553974,11776.2942436,11854.0622245,11915.165638,11937.3850611,12020.7078977,12142.9147248,12198.4632825,12242.9021287,12315.1152538,12365.1089558,12492.8706386,12548.4191964,12565.0837637,12603.9677541,13170.5630432,13309.4344376,13448.305832,13576.0675148,13587.1772264,13609.3966495,13631.6160726,13653.8354957,13737.1583323,13776.0423227,13837.1457362,13853.8103036,13870.4748709,13898.2491498,13914.9137171,13926.0234286,13937.1331402,13953.7977075,13992.6816979,14009.3462653,14020.4559768,14031.5656884,14042.6753999,14142.6628039,14175.9919385,14203.7662174,14220.4307847,14259.3147752,14287.089054,14342.6376118,14370.4118907,14381.5216022,14414.8507369,14425.9604484,14448.1798715,14492.6187177,14503.7284293,14537.0575639,14548.1672755,14570.3866986,14587.0512659,14620.3804006,14631.4901121,14648.1546794,14664.8192468,14675.9289583,14703.7032372,14725.9226603,14748.1420834,14764.8066507,14787.0260738,14803.6906411,14814.8003527,14831.46492,14842.5746316,14859.2391989,14875.9037662,14892.5683335,14909.2329009,14925.8974682,14942.5620355,15398.0602091,15409.1699206,15431.3893437,15453.6087668,15464.7184784,15525.8218919,15536.9316035,15564.7058824,15620.2544401,15631.3641517,15653.5835748,15675.8029979,15686.9127094,15709.1321325,15725.7966998,15742.4612672,15759.1258345,15770.235546,15792.4549691,15814.6743922,15825.7841038,15842.4486711,15853.5583827,15864.6680942,15892.4423731,15903.5520846,15914.6617962,15942.4360751,15953.5457866,15964.6554982,15981.3200655,16014.6492002,16036.8686233,16047.9783348);
massEigenValues=(0.307097160922,0.353952113462,0.408994552129,0.372982862282,0.647237554647,0.758317349968,0.758203169801,0.689802351432,0.528513809846,0.700408139844,0.682225285835,0.544624931035,0.5410566383,0.499916481675,0.676639141973,0.663355786086,0.697777172249,0.540595517866,0.517546959416,0.519640517182,0.520823163522,0.527809883236,0.531500717238,0.396071792783,0.410248639819,0.404123521486,0.394861595297,0.493810911601,0.316497816057,0.322646014375,0.701896333724,0.517856904733,0.545422420081,0.544516042697,0.454519689422,0.969947248718,0.920405680955,0.583146638907,0.541432180108,0.354703882079,0.638577840168,0.605257648263,0.705413574828,0.721702576385,0.711838250799,0.691111421559,0.735139697544,0.875855246906,0.855008286548,0.811838148886,0.530614361874,0.484216442739,0.339157358546,0.335687461972,0.41016313292,0.3873314286,0.566914165954,0.665387216842,0.772551876444,0.747000916781,0.730876043822,0.682257125554,0.767288245532,0.785284003717,1.0,0.935546862802,0.923865100657,0.903678941495,0.945461823048,0.772640376643,0.643209646444,0.504075450922,0.530226387039,0.510446434337,0.314942688825,0.27484499237,0.267601803379,0.264707879377,0.217342448444,0.218455265742,0.198182250913,0.196997981969,0.174074017567,0.231377743877,0.309026542731,0.283081058333,0.294570797692,0.239728034723,0.244186813556,0.230660343753,0.266077188668,0.25268024948,0.243692234087,0.227421747957,0.249302949243,0.219272800481,0.243080548425,0.236955542987,0.242039298031,0.187781303381,0.187547935528,0.198670218123,0.198399992444,0.191922503712,0.225828551011,0.206921205851,0.213022615468,0.2258482655,0.229370516039,0.247965027393,0.244559095423,0.228020783073,0.250621311601,0.251037942198,0.226649525828,0.226875418903,0.220919767673,0.202873125894,0.222363493201,0.226835899495,0.200686533064,0.20022683434,0.165588118449,0.164347260073,0.142980453403,0.10326189197,0.102810438577,0.107585837288,0.12562772553,0.11381033369,0.103455544523,0.110185835407,0.102494444596,0.096457339868,0.0836251361523,0.0823721546124,0.0663347758383,0.054967111324,0.0528196174377,0.0607484825609,0.0577382804808,0.0551228053118,0.0619753800947,0.0526319487953,0.0460768332072,0.0397861258115,0.0399825321226,0.0394832632902,0.0323534441548,0.0348154902276,0.032926786023,0.0318608726973,0.0335291952125,0.034482900561,0.03577427031,0.033187080383,0.0334818333904,0.0315305408337,0.0310516617902,0.0281215630381,0.023704128765,0.0216310404164,0.0239983594957,0.017796006342,0.019710638391,0.0149620521496,0.0112029013381,0.0110134275874,0.012171082203,0.0120918535509,0.0134204812534,0.0138799635289,0.0164342652073,0.0161674601917,0.0150626556124,0.0140527744632,0.0147230198283,0.018963959308,0.0165469090363,0.0182129475048,0.0190817184522,0.0189944333355,0.0178124360217,0.0182205460651,0.0181175826461,0.0177497731958,0.017208767719,0.0190165583742,0.019472194516,0.019746473062,0.0198134381774,0.0197243435926,0.0222130643917,0.0195022998455,0.0181384616323,0.0181005403527,0.0197337814589,0.0180515798591,0.0165460648104,0.0173243629522,0.0168186473041,0.0160730544102,0.0158388434822,0.0156542814568,0.0151799700193,0.0162523937356,0.0145648023119,0.0139623141329,0.0140792094877,0.0132598705299,0.0132660074465,0.013548015577,0.0132841720488,0.0132589803371,0.013467848114,0.0134039692302,0.0138790357689,0.0137984179574,0.0137300271046,0.0137104410142,0.0142355976982,0.0139812932556,0.0129116004808,0.0127387834033,0.0118561177047,0.0114161396557,0.011404852566,0.0110639112939,0.0113420267675,0.0108538408815,0.0108812587085,0.0110698742111,0.0111814543479,0.0103204239947,0.0101956655646,0.010456120685,0.0105498036053,0.0100567388096,0.01004548367,0.0105163535312,0.0105794326455,0.0104707050025,0.0106648501728,0.0109278172549,0.0104205154346,0.0105429618501,0.0106429661227,0.011391621943,0.0114959467502,0.011339260898,0.0107438303743,0.0105193454387,0.011070409158,0.0106615897247,0.0108808442431,0.0105143605788,0.0105811539521,0.0116227007119,0.0110320614019,0.0102875354698,0.0107725688009,0.0101866059004,0.0100817801797,0.010872899328);
t60=(0.0986108143979,0.0994118910513,0.610979531587,0.0994118910513,0.284218437251,0.298078928886,0.298078928886,0.290983677212,0.298078928886,0.643132225291,0.610979531587,0.197143252978,0.197143252978,0.190984975253,0.305528943153,0.207163501523,0.555443060688,0.197143252978,0.190984975253,0.190984975253,0.203712082574,0.207163501523,0.210733934924,0.0398765187876,0.0400065778447,0.0398765187876,0.0398765187876,0.200373824908,0.0396189260953,0.0396189260953,0.718785622302,0.0970468076064,0.0986108143979,0.0986108143979,0.0769212874683,0.763704826809,0.581888999203,0.174621551698,0.0986108143979,0.0396189260953,0.939926321566,0.872794323539,0.939926321566,0.763704826809,0.718785622302,0.763704826809,0.239647444806,0.254620512528,0.254620512528,0.24443882647,0.123492741768,0.12225859813,0.555443060688,0.555443060688,0.0417781332279,0.0414954234646,0.0624152329582,0.128689136067,0.298078928886,0.290983677212,0.452597744427,0.128689136067,0.678857440537,0.678857440537,0.678857440537,0.939926321566,0.939926321566,0.814613258605,0.610979531587,0.939926321566,0.939926321566,0.939926321566,0.939926321566,0.872794323539,0.872794323539,0.872794323539,0.763704826809,0.718785622302,0.172163197002,0.172163197002,0.0227463823712,0.0227463823712,0.0198167741272,0.0246126121424,0.0867310184335,0.0694989631848,0.070296900655,0.0256927299376,0.0259640670811,0.0246126121424,0.0605636441966,0.0261296463871,0.025746541336,0.024514475741,0.0260742184201,0.0239884569944,0.025746541336,0.0246126121424,0.0256927299376,0.0226625825308,0.0226625825308,0.0227463823712,0.0227463823712,0.0227044048583,0.024514475741,0.0237109721954,0.0238489048115,0.024514475741,0.0245634456083,0.0260742184201,0.0259640670811,0.024514475741,0.0260742184201,0.0260742184201,0.024514475741,0.024514475741,0.0240824056841,0.0237109721954,0.0240824056841,0.024514475741,0.0236199030084,0.0236199030084,0.0192590222522,0.0192590222522,0.0191393313718,0.0153319415627,0.0153319415627,0.0153701226114,0.0169775302929,0.0154084952857,0.0153319415627,0.0153892849053,0.0153319415627,0.0153129224499,0.0151438610824,0.0151253078254,0.0148882084831,0.0132303018198,0.0132161602651,0.226338051331,0.0136239765034,0.0132303018198,0.235040347058,0.0132161602651,0.0129667140414,0.0126874064918,0.0126874064918,0.0126874064918,0.00571953085919,0.0112365405185,0.0112060546479,0.00571692797011,0.0112161980776,0.0112263600176,0.0112569574068,0.0112161980776,0.0112161980776,0.00571692797011,0.00570913369767,0.00562479784959,0.00557737726812,0.00557243276442,0.00557737726812,0.00555519681877,0.0055625703899,0.00546348604412,0.00540248656462,0.00540248656462,0.00545637638613,0.678857440537,0.678857440537,0.0430996023386,0.0509868168241,0.0507755786847,0.0499478700703,0.0430996023386,0.044833055849,0.067210373342,0.0514146184385,0.067210373342,0.067210373342,0.067210373342,0.0637139167773,0.067210373342,0.0668435319893,0.0637139167773,0.0522921602287,0.067210373342,0.0750355724039,0.0764410194097,0.0764410194097,0.0764410194097,0.107254010001,0.0750355724039,0.0668435319893,0.0668435319893,0.0764410194097,0.0637139167773,0.0514146184385,0.0522921602287,0.0514146184385,0.0507755786847,0.0505660863164,0.0499478700703,0.0499478700703,0.0509868168241,0.044833055849,0.0430996023386,0.0430996023386,0.0429486508916,0.0429486508916,0.0430996023386,0.0429486508916,0.0429486508916,0.0430996023386,0.0429486508916,0.0430996023386,0.0430996023386,0.0430996023386,0.0430996023386,0.0430996023386,0.0430996023386,0.0427987550503,0.0426499037805,0.0425020862013,0.0391136164816,0.0391136164816,0.034111896908,0.0391136164816,0.034111896908,0.0736809247056,0.0837634627588,0.0837634627588,0.0723743710262,0.0719491006169,0.0723743710262,0.0723743710262,0.0711133948183,0.0711133948183,0.0723743710262,0.0723743710262,0.0723743710262,0.0723743710262,0.0736809247056,0.0723743710262,0.0723743710262,0.0723743710262,0.0849257553911,0.0849257553911,0.0849257553911,0.0736809247056,0.0723743710262,0.0837634627588,0.0723743710262,0.0736809247056,0.0723743710262,0.0723743710262,0.0849257553911,0.0837634627588,0.0723743710262,0.0736809247056,0.0719491006169,0.0719491006169,0.0736809247056);

modeFreqs=par(i,nModes,ba.take(i+1, modeFrequencies));
modeGains=par(i,nModes,ba.take(i+1, massEigenValues));
modeT60 = par(i,nModes,ba.take(i+1,t60));

cabinetFenderBlackfaceTreble=modalModel(nModes,modeFrequencies,modeT60,modeGains);

modalModel(n,modeFreqs,modeRes,modeGains) = _ <: par(i,n,gain(i)*pm.modeFilter(freqs(i),res(i))) :> _
with {
	freqs(i) = ba.take(i+1,modeFreqs);
	res(i) = ba.take(i+1,modeRes);
	gain(i) = ba.take(i+1,modeGains);
};


cab = cabinetFenderBlackfaceTreble;

wetdry = vslider("[2] amount[style:knob]",  1, 0, 1, 0.01);
dry = 1 - wetdry;

process = _ <: _*dry, (_*wetdry:cab) :> _;
