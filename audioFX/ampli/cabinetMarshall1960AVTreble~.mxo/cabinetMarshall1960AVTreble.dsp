declare name "cabinetMarshall1960AVTreble";
declare description "Generated by tools/physicalModeling/ir2dsp.py";

import("stdfaust.lib");

pi = 4*atan(1.0);
nModes = 260;

modeFrequencies=(72.2131250787,122.206827056,161.090817483,183.310240584,227.749086787,338.846202292,477.717596675,577.70500063,627.698702607,716.576395012,766.57009699,888.776924046,1022.09346265,1183.18428014,1210.95855901,1305.39110719,1422.04307847,1494.25620355,1533.14019398,1638.68245371,1760.88928077,1905.31553092,1955.3092329,1994.19322333,2166.39375236,2227.49716589,2305.26514674,2427.4719738,2571.89822396,2688.55019524,2755.20846454,2821.86673385,2960.73812823,3094.05466683,3127.38380149,3188.48721501,3232.92606122,3366.24259982,3405.12659025,3427.34601335,3494.00428266,3566.21740773,3638.43053281,3799.5213503,3932.8378889,4043.93500441,4177.25154302,4366.11663938,4471.65889911,4532.76231263,4632.74971659,4793.84053407,4910.49250535,5027.14447663,5182.68043834,5282.6678423,5299.33240962,5493.75236176,5549.30091951,5643.73346769,5804.82428517,5899.25683335,5954.80539111,6127.00592014,6221.43846832,6393.63899735,6515.84582441,6604.72351682,6649.16236302,6699.156065,6765.8143343,6843.58231515,6954.67943066,6993.56342109,7054.66683461,7115.77024814,7193.538229,7254.64164252,7337.96447915,7382.40332536,7404.62274846,7471.28101776,7510.16500819,7615.70726792,7737.91409497,7865.67577781,7954.55347021,8048.98601839,8060.09572994,8082.31515304,8271.1802494,8348.94823026,8476.70991309,8571.14246127,8587.80702859,8610.02645169,8637.80073057,8665.57500945,8737.78813453,8776.67212495,8815.55611538,8871.10467313,8893.32409623,8904.43380778,8965.53722131,8993.31150019,9004.42121174,9026.64063484,9104.40861569,9121.07318302,9221.06058698,9243.28001008,9259.9445774,9315.49313516,9343.26741403,9398.81597178,9487.69366419,9626.56505857,9704.33303943,9726.55246253,9748.77188563,9776.5461645,9848.75928958,9915.41755889,9982.07582819,9993.18553974,10098.7277995,10109.837511,10215.3797708,10232.0443381,10248.7089054,10304.2574632,10320.9220305,10359.8060209,10376.4705882,10398.6900113,10437.5740018,10493.1225595,10554.225973,10615.3293866,10687.5425117,10765.3104925,10893.0721753,10915.2915984,10937.5110215,10948.6207331,10965.2853004,11070.8275601,11115.2664063,11181.9246757,11226.3635219,11237.4732334,11254.1378007,11331.9057816,11343.0154931,11454.1126086,11504.1063106,11520.7708779,11570.7645799,11598.5388588,11654.0874166,11737.4102532,11904.0559264,12031.8176093,12065.1467439,12187.353571,12198.4632825,12270.6764076,12337.3346769,12403.9929462,12465.0963597,12481.7609271,12753.9488601,12765.0585716,12776.1682832,12792.8328505,12803.942562,12848.3814082,13003.9173699,13503.8543897,13520.518957,13576.0675148,13653.8354957,13664.9452072,13714.9389092,13764.9326112,13781.5971785,13792.70689,13803.8166016,13814.9263131,13831.5908805,13870.4748709,13909.3588613,14026.0108326,14042.6753999,14064.894823,14081.5593904,15670.2481421,15764.6806903,15798.0098249,15820.229248,15848.0035269,15881.3326615,15892.4423731,15903.5520846,15914.6617962,15925.7715077,15936.8812193,15947.9909308,15959.1006424,15975.7652097,15997.9846328,16014.6492002,16025.7589117,16036.8686233,16047.9783348,16064.6429021,16075.7526137,16086.8623252,16103.5268926,16120.1914599,16153.5205945,16181.2948734,16192.404585,16203.5142965,16220.1788638,16236.8434312,16253.5079985,16264.61771,16281.2822774,16297.9468447,16314.611412,16331.2759793,16342.3856909,16353.4954024,16375.7148255,16409.0439602,16420.1536717,16442.3730948,16453.4828064,16464.5925179,16481.2570853,16497.9216526,16514.5862199,16531.2507873,16542.3604988,16553.4702104,16564.5799219,16581.2444892,16603.4639123,16614.5736239,16625.6833354,16659.0124701,16681.2318932,16697.8964605,16714.5610278,16725.6707394,16747.8901625,16770.1095856,16781.2192971);
massEigenValues=(0.0865440583019,0.284527297174,0.361669632467,0.365573466014,0.404143569709,0.600709434406,0.654598307837,0.461829323171,0.489538305199,0.535811174936,0.671617293471,0.642343415022,0.704875914789,0.579466177077,0.533427966529,0.47704854954,0.415708281854,0.515386443486,0.644401577738,0.785928291681,0.517475512899,0.444581214416,0.432880529798,0.495123433692,0.791266179869,0.793282770862,0.91555296607,0.748632354643,0.550900889245,0.539115302397,0.518317922356,0.568659589747,0.671943773438,0.783330895046,0.769045430538,0.724047521443,0.706230044532,0.648510703676,0.648346841269,0.635695909572,0.641455917546,0.596479389933,0.616159829417,0.728499112296,1.0,0.91351813227,0.515106011776,0.510534445609,0.476628314305,0.414696368892,0.331469949172,0.349353410476,0.495302333814,0.535259335359,0.47753996568,0.376895564607,0.377470972341,0.248592349848,0.246426368613,0.21003188459,0.129562627323,0.0921950919947,0.087710177067,0.0618873518395,0.0799294134417,0.160107986032,0.101192866353,0.0396738908134,0.0443790180766,0.0388095359873,0.0475415824578,0.0406184488711,0.0545322932365,0.0524733517212,0.0524549516362,0.0557398001118,0.0609867219178,0.0681499916205,0.0735184475821,0.072421712286,0.0725928127321,0.074077571932,0.0734295897336,0.0639960455614,0.0425491773796,0.0281638965655,0.0200683628861,0.0201790505465,0.0198447620772,0.0211238985382,0.046065471155,0.0536035142337,0.0481496636373,0.03699852045,0.0367111427354,0.0371703072056,0.0364848854135,0.0366017486838,0.0305491112894,0.0304889235553,0.0281381884644,0.0265554069454,0.027295376593,0.0272025990315,0.0260718882572,0.0263857352469,0.0263792845008,0.0264016020768,0.0326359734523,0.0321853481141,0.0389800624754,0.0382782647957,0.0389002008473,0.0397450278709,0.0398397374338,0.0415740052177,0.051464356412,0.0702327354079,0.0743738917103,0.0741564475631,0.072344140569,0.0719944380042,0.0643970294059,0.0592710523001,0.0543521744539,0.05486577136,0.0471082087028,0.0472201175476,0.0378435262231,0.038045692827,0.0381387893176,0.0338078029639,0.0330757746665,0.0334207554874,0.0330031172087,0.0336125875456,0.0287344730585,0.0328492249075,0.0282613208312,0.0279149542139,0.0205769217561,0.012250992498,0.0103859966461,0.0110269517156,0.0120262604921,0.0120502945796,0.0126372940149,0.0196797420334,0.0190303086437,0.0233024325035,0.0254560558084,0.0255687146839,0.0253700314935,0.0334785416624,0.0333678984367,0.0404144508777,0.0406171254063,0.0400968551103,0.0421731473183,0.041914284658,0.0418882809491,0.0417074562189,0.0367349411802,0.0298574632243,0.0296630356868,0.0254548101003,0.0254184981646,0.0200305132535,0.0219937354064,0.0173868582214,0.0152107636057,0.0151500681072,0.0151225914993,0.0150496617744,0.015145678007,0.0154220376265,0.0154066947643,0.0146029716364,0.010238253022,0.0142265553632,0.0140264175018,0.0161173462181,0.0201777601305,0.0201737402881,0.0217592424605,0.0239052090517,0.0245020227776,0.0243211924493,0.0243841295743,0.0241930671031,0.0234566433554,0.0217991580137,0.0198539867142,0.0128691791332,0.0120132855377,0.0113799916706,0.0110558108212,0.0101128231239,0.0105187824133,0.0105855626231,0.0109570432665,0.011571102007,0.0113082014877,0.0115118661648,0.0119154280608,0.0114907209163,0.0112204660586,0.0116218038542,0.0112189501979,0.0117602312391,0.0120692831073,0.012776430267,0.0128697922516,0.012756498579,0.0121223943616,0.0118491468175,0.0118317757693,0.0118885035538,0.0116678622054,0.0120861444562,0.0115350567043,0.0114677449191,0.011304995112,0.0111003316643,0.0103404137581,0.0111847986938,0.0104982079485,0.0102370308884,0.0108858779595,0.0108590963971,0.0107794795705,0.0107471011899,0.0108046581967,0.010287825856,0.0110048014628,0.0112138431802,0.0114317002561,0.0106045620886,0.0112548038291,0.0114818100313,0.0109653526171,0.0108860786319,0.0113580547072,0.0115720066548,0.0111680829763,0.0109114267527,0.0110152285163,0.0110734499036,0.0111959794431,0.011956638295,0.010433435183,0.0105692887717,0.0106582669554,0.0108953103088,0.010871952382,0.0100930982091,0.0105044623288,0.0104083273852,0.0105198758725,0.0103033744593);
t60=(0.011475934323,0.0122599918612,0.094063163912,0.0947917280661,0.126037367835,0.509162668329,0.718785622302,0.128689136067,0.131454958861,0.581888999203,0.718785622302,0.872794323539,1.35763653188,0.359431987757,0.321605289754,0.277760708206,0.0207519185459,0.169773129941,0.260036302995,0.555443060688,0.169773129941,0.0208927933439,0.0208573949563,0.0277836876146,0.172163197002,0.172163197002,0.197143252978,0.165186785054,0.0281014077532,0.0280372820852,0.0279099071844,0.0282305456213,0.051631226853,0.0892610221477,0.0886147711953,0.0849257553911,0.0843406011682,0.0511998226482,0.0511998226482,0.0427987550503,0.0427987550503,0.0420647290407,0.0425020862013,0.160841826757,0.284218437251,0.197143252978,0.0279099071844,0.24942577474,0.0244657013629,0.0207519185459,0.0154858213102,0.0155052748597,0.130057335639,0.15875398966,0.117559358926,0.100226100112,0.100226100112,0.0121755669397,0.0121636016737,0.0121041286542,0.0117147335182,0.0115186205825,0.011475934323,0.0104768594476,0.452597744427,0.470002336384,0.239647444806,0.00881822374361,0.00883074439005,0.00881197684532,0.00884959277345,0.00881822374361,0.0719491006169,0.0647240042107,0.0647240042107,0.0769212874683,0.0815318609316,0.0892610221477,0.117559358926,0.116440492457,0.116440492457,0.117559358926,0.117559358926,0.0843406011682,0.00882447958545,0.00867676958349,0.0064289910038,0.0064289910038,0.0064289910038,0.006432293137,0.128689136067,0.197143252978,0.131454958861,0.0947917280661,0.0861207886704,0.0947917280661,0.0861207886704,0.0861207886704,0.026467242227,0.026467242227,0.0258548452921,0.0253745408132,0.0254797218307,0.0254797218307,0.0253222762797,0.0253745408132,0.0253745408132,0.0253745408132,0.0266972094877,0.0266972094877,0.0446697178213,0.0441867797612,0.0446697178213,0.0453303294073,0.0453303294073,0.0501522530355,0.0620988023873,0.116440492457,0.1328829652,0.131454958861,0.127349440656,0.121048892983,0.107254010001,0.0919432065767,0.0826325834499,0.0826325834499,0.0579837054606,0.0579837054606,0.04402811666,0.0441867797612,0.0441867797612,0.0268137027544,0.0267553289446,0.0267553289446,0.0267553289446,0.0268137027544,0.0260742184201,0.0266972094877,0.0258548452921,0.0258005793096,0.006432293137,0.00639615749653,0.0281658282525,0.039747304271,0.0401374897492,0.0401374897492,0.0404019058763,0.0451633482481,0.0449975948928,0.048755771847,0.0507755786847,0.0507755786847,0.0507755786847,0.0719491006169,0.0715288041324,0.0873499657672,0.0873499657672,0.0861207886704,0.10450591701,0.103620937917,0.103620937917,0.101895228693,0.0815318609316,0.0624152329582,0.0620988023873,0.0507755786847,0.0507755786847,0.0453303294073,0.0476193358445,0.0443465925963,0.0419209403875,0.0419209403875,0.226338051331,0.226338051331,0.226338051331,0.235040347058,0.235040347058,0.21825734818,0.0281658282525,0.106322048027,0.105406154366,0.113208211565,0.143819813862,0.143819813862,0.156719686852,0.185199926501,0.188047950499,0.188047950499,0.188047950499,0.188047950499,0.179755174754,0.156719686852,0.13891953749,0.101053767176,0.0919432065767,0.0905822463244,0.0879778188202,0.039491376167,0.0408051404786,0.0408051404786,0.044833055849,0.0518496709334,0.0460108090311,0.0460108090311,0.0624152329582,0.0460108090311,0.0460108090311,0.0518496709334,0.0460108090311,0.0571719490641,0.0624152329582,0.0637139167773,0.0637139167773,0.0637139167773,0.0624152329582,0.0571719490641,0.0571719490641,0.0571719490641,0.0548677258312,0.0624152329582,0.0460108090311,0.0460108090311,0.0460108090311,0.044833055849,0.039491376167,0.044833055849,0.0408051404786,0.039491376167,0.044833055849,0.044833055849,0.0429486508916,0.0429486508916,0.0438705909298,0.039491376167,0.044833055849,0.0460108090311,0.0460108090311,0.0429486508916,0.0460108090311,0.0460108090311,0.044833055849,0.044833055849,0.0460108090311,0.0518496709334,0.044833055849,0.044833055849,0.044833055849,0.044833055849,0.0460108090311,0.0624152329582,0.0408051404786,0.0408051404786,0.0429486508916,0.044833055849,0.044833055849,0.039491376167,0.0408051404786,0.0408051404786,0.0408051404786,0.039491376167);

modeFreqs=par(i,nModes,ba.take(i+1, modeFrequencies));
modeGains=par(i,nModes,ba.take(i+1, massEigenValues));
modeT60 = par(i,nModes,ba.take(i+1,t60));

cabinetMarshall1960AVTreble=modalModel(nModes,modeFrequencies,modeT60,modeGains);

modalModel(n,modeFreqs,modeRes,modeGains) = _ <: par(i,n,gain(i)*pm.modeFilter(freqs(i),res(i))) :> _
with {
	freqs(i) = ba.take(i+1,modeFreqs);
	res(i) = ba.take(i+1,modeRes);
	gain(i) = ba.take(i+1,modeGains);
};


cab = cabinetMarshall1960AVTreble;

wetdry = vslider("[2] amount[style:knob]",  1, 0, 1, 0.01);
dry = 1 - wetdry;

process = _ <: _*dry, (_*wetdry:cab) :> _;
