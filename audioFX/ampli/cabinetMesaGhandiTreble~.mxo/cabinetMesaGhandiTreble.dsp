declare name "cabinetMesaGhandiTreble";
declare description "Generated by tools/physicalModeling/ir2dsp.py";

import("stdfaust.lib");

pi = 4*atan(1.0);
nModes = 28;

modeFrequencies=(177.108433735,708.43373494,974.096385542,1239.75903614,1593.97590361,2213.85542169,2656.62650602,3099.39759036,3542.1686747,3719.27710843,4162.04819277,4516.26506024,4959.03614458,6198.79518072,6730.12048193,7350.0,8146.98795181,8678.31325301,9740.96385542,10095.1807229,10803.6144578,11157.8313253,12220.4819277,12840.3614458,13460.2409639,14611.4457831,15319.8795181,16116.8674699);
massEigenValues=(1.0,0.36751606489,0.298870274002,0.376965946141,0.431845320751,0.621944802822,0.711148807806,0.997135886921,0.578672242824,0.56869872828,0.512754999047,0.59389630814,0.628170641703,0.0373450160688,0.0616765194919,0.0485742044011,0.029503256078,0.028222767439,0.0426637334594,0.0485623746681,0.0229874255324,0.0268915380165,0.0219745643631,0.0282216190443,0.0384767082243,0.0270342790581,0.0204156906017,0.0191714119422);
t60=(64.9257074788,16.2314856284,16.2314856284,64.9257074788,64.9257074788,8.46863866678,38.9554558249,38.9554558249,5.12578590831,5.12578590831,4.86950053017,12.9852041717,13.9127131593,48.6943001959,32.4628929119,27.825347974,5.72881032748,5.72881032748,16.2314856284,17.7070681088,21.641954723,24.3471892701,4.86950053017,11.4575423098,19.477767085,6.9563957522,4.75073413542,3.89561609326);

modeFreqs=par(i,nModes,ba.take(i+1, modeFrequencies));
modeGains=par(i,nModes,ba.take(i+1, massEigenValues));
modeT60 = par(i,nModes,ba.take(i+1,t60));

cabinetMesaGhandiTreble=modalModel(nModes,modeFrequencies,modeT60,modeGains);

modalModel(n,modeFreqs,modeRes,modeGains) = _ <: par(i,n,gain(i)*pm.modeFilter(freqs(i),res(i))) :> _
with {
	freqs(i) = ba.take(i+1,modeFreqs);
	res(i) = ba.take(i+1,modeRes);
	gain(i) = ba.take(i+1,modeGains);
};


cab = cabinetMesaGhandiTreble;

wetdry = vslider("[2] amount[style:knob]",  1, 0, 1, 0.01);
dry = 1 - wetdry;

process = _ <: _*dry, (_*wetdry:cab) :> _;
