declare name "cabinetRandallExcelTreble";
declare description "Generated by tools/physicalModeling/ir2dsp.py";

import("stdfaust.lib");

pi = 4*atan(1.0);
nModes = 295;

modeFrequencies=(72.2131250787,122.206827056,161.090817483,183.310240584,227.749086787,333.291346517,472.162740899,566.595289079,633.253558383,716.576395012,761.015241214,883.222068271,1027.64831843,1172.07456859,1216.51341479,1260.95226099,1333.16538607,1422.04307847,1549.8047613,1644.23730948,1777.55384809,1821.99269429,1921.98009825,2060.85149263,2077.51605996,2105.29033883,2216.38745434,2360.8137045,2499.68509888,2616.33707016,2649.66620481,2799.64731074,2882.97014737,2916.29928203,3094.05466683,3205.15178234,3244.03577277,3310.69404207,3366.24259982,3421.79115758,3516.22370576,3566.21740773,3666.20481169,3699.53394634,3805.07620607,3888.3990427,4016.16072553,4110.59327371,4143.92240836,4255.01952387,4321.67779317,4399.44577403,4449.439476,4516.09774531,4654.96913969,4793.84053407,4810.5051014,4916.04736113,4966.04106311,5060.47361129,5166.01587102,5227.11928454,5332.66154428,5410.42952513,5510.41692908,5632.62375614,5699.28202544,5771.49515052,5871.48255448,5910.3665449,5993.68938153,6027.01851619,6043.68308351,6110.34135282,6138.11563169,6199.21904522,6254.76760297,6288.09673762,6354.75500693,6388.08414158,6410.30356468,6504.73611286,6638.05265147,6732.48519965,6804.69832473,6876.9114498,6932.46000756,7026.89255574,7071.33140194,7204.64794055,7360.18390225,7410.17760423,7437.95188311,7454.61645043,7476.83587354,7487.94558509,7515.71986396,7676.81068145,7760.13351808,7860.12092203,7887.89520091,7899.00491246,7965.66318176,8004.54717219,8171.19284545,8193.41226855,8260.07053785,8276.73510518,8298.95452828,8332.28366293,8393.38707646,8426.71621111,8515.59390351,8532.25847084,8548.92303817,8560.03274972,8587.80702859,8743.3429903,8776.67212495,8787.7818365,8859.99496158,9021.08577907,9032.19549062,9159.95717345,9176.62174077,9315.49313516,9465.47424109,9565.46164504,9609.90049125,9765.43645295,9920.97241466,9937.63698199,9998.74039552,10104.2826552,10132.0569341,10320.9220305,10354.2511651,10398.6900113,10437.5740018,10704.207079,10737.5362136,10748.6459252,10765.3104925,10781.9750598,10837.5236176,10848.6333291,10976.395012,11004.1692908,11109.7115506,11143.0406852,11154.1503968,11231.9183776,11259.6926565,11298.5766469,11337.4606374,11348.5703489,11359.6800605,11370.789772,11498.5514548,11531.8805895,11542.990301,11654.0874166,11665.1971281,11698.5262628,11748.5199647,11759.6296763,11770.7393878,11781.8490994,11792.9588109,11804.0685225,11820.7330898,11831.8428014,11848.5073687,11865.171936,11909.6107822,11981.8239073,12148.4695806,12737.2842927,12770.6134274,12798.3877063,12848.3814082,12920.5945333,12953.923668,13070.5756392,13509.4092455,13531.6286686,13603.8417937,13659.3903514,13676.0549188,13687.1646303,13714.9389092,13731.6034765,13742.7131881,13753.8228996,13809.3714574,13820.4811689,13842.700592,13859.3651593,13876.0297267,13887.1394382,13903.8040055,13931.5782844,13942.687996,13953.7977075,13964.9074191,13976.0171306,14014.901121,14031.5656884,14048.2302557,14076.0045346,14098.2239577,14109.3336692,14137.1079481,14148.2176597,14159.3273712,14170.4370828,14214.875929,14225.9856405,14242.6502078,14259.3147752,14309.3084771,14331.5279002,14342.6376118,14359.3021791,14370.4118907,14381.5216022,14392.6313138,14403.7410253,14420.4055926,14514.8381408,14531.5027081,14542.6124197,14553.7221313,14648.1546794,14659.264391,14703.7032372,14748.1420834,14764.8066507,14781.471218,14825.9100642,14859.2391989,14870.3489104,14892.5683335,15020.3300164,15042.5494395,15053.659151,15070.3237184,15081.4334299,15092.5431415,15103.652853,15114.7625646,15148.0916992,15159.2014108,15181.4208339,15198.0854012,15214.7499685,15242.5242474,15253.6339589,15270.2985263,15309.1825167,15342.5116513,15353.6213629,15386.9504975,15403.6150649,15420.2796322,15436.9441995,15448.0539111,15481.3830457,15492.4927573,15509.1573246,15525.8218919,15553.5961708,15620.2544401,15631.3641517,15648.028719,15670.2481421,15686.9127094,15709.1321325,15736.9064114,15759.1258345,15770.235546,15781.3452576,15792.4549691,15803.5646807,15814.6743922,15831.3389596,15848.0035269,15859.1132384,15875.7778058,15897.9972289,15914.6617962,15925.7715077,16336.8308351,16353.4954024,16370.1599698);
massEigenValues=(0.123136253493,0.364451601024,0.549273361601,0.568457703311,0.57838873573,0.867446177413,0.847527959825,0.309278063873,0.946906727725,0.657210227559,0.64646181884,0.478231364062,0.566489977358,0.670549111369,0.867415419861,0.566959187449,0.453483585164,0.392763745191,0.437661858176,0.488581485653,0.513222489124,0.565169702762,0.659480989415,0.501711358818,0.495218583652,0.453450488234,0.795382203183,0.959527598375,1.0,0.659301770634,0.685785077271,0.756825613731,0.484621876705,0.46670013209,0.627827088615,0.719904436333,0.703803107495,0.713962422441,0.690886779824,0.64531635086,0.585155941539,0.655216054554,0.61452413873,0.577473678601,0.500222803559,0.576787013504,0.502730655517,0.463705235695,0.458923166899,0.596533484864,0.697732287991,0.66508078817,0.633251158774,0.691715475805,0.627997524331,0.490476803586,0.488751245883,0.496658031856,0.506799406267,0.504721922068,0.5324317315,0.557814721221,0.482876869032,0.484261623934,0.652851787366,0.655252730724,0.577618940323,0.597618627761,0.416279338953,0.406448642526,0.3702988505,0.343499107449,0.34448122782,0.324643235509,0.315618560747,0.33737853602,0.352082252211,0.346098723087,0.321891351683,0.299038940141,0.300111235444,0.228577160332,0.159691131562,0.114601911515,0.121682503604,0.108729897844,0.107563811742,0.0838762259766,0.0815650133946,0.0655206143831,0.0445755693434,0.0462358977008,0.0459477971589,0.0455680964527,0.0470873345305,0.0470275157691,0.0488443491535,0.026514564428,0.0191958661589,0.0166178475868,0.018014568256,0.0181378545713,0.0124833985073,0.0101652059265,0.0115604348742,0.0108337692146,0.0146771130566,0.0147356628908,0.0139511069911,0.0137698729645,0.0198990894938,0.0188483489921,0.022291918247,0.0221821386061,0.022609060006,0.0226477649424,0.021107376104,0.0174419411476,0.0163826233748,0.0168778120159,0.0193329310342,0.0132802248259,0.0134469759863,0.0215717585309,0.0223000442599,0.0276641678183,0.0283999263959,0.0284666193139,0.026313690278,0.0115152595225,0.0170997610176,0.0165455022227,0.0200491942066,0.0252567458023,0.0263994959721,0.0442915773594,0.0432847412144,0.0418051476031,0.0395566018466,0.0150557494355,0.0134611882263,0.0138179035592,0.0138508912149,0.0138311053226,0.0157640445333,0.0156562364125,0.0223119785807,0.0210529442416,0.027303618834,0.027466824666,0.0274583550507,0.0317300335775,0.0328556692153,0.0322834818418,0.0306058071391,0.0305552477248,0.0304978677448,0.0303026854279,0.0248000316212,0.0235318406692,0.0232287710009,0.0173870915228,0.0175609336456,0.0184080618841,0.0187402409228,0.0187325837629,0.0186421091146,0.0186578513866,0.0189139550865,0.0189177577218,0.0186975739763,0.0187697418026,0.0191170056313,0.0189137630714,0.0202567112126,0.0187582033221,0.0103790868767,0.0252880307873,0.0249027892368,0.0247151630747,0.0268874654801,0.0212606193873,0.0205831006562,0.0144870567405,0.0156795208537,0.0166686634904,0.0194556405686,0.0165690437954,0.0166590698535,0.0165679135459,0.0158811584446,0.0155464686505,0.0153237187302,0.0153187007108,0.0115020685547,0.0116041737544,0.0120089966129,0.011793122628,0.0114861096767,0.0114983977123,0.0112690312214,0.0120637343208,0.012241989433,0.0127174246135,0.0127321161327,0.0124225532444,0.0139725315097,0.0139292102716,0.0134907143937,0.0129381361826,0.012791288072,0.0122083061886,0.0113643199311,0.0114047513667,0.0115568901948,0.0113963971941,0.0110500964398,0.0109057151638,0.0109021451742,0.0102359858863,0.010384655776,0.0107265747518,0.0107665303672,0.0114784295224,0.0118302688653,0.0116992957265,0.0118640545235,0.0118855454703,0.0111066671045,0.0160297148648,0.0174564303914,0.0175249089743,0.0179524292085,0.0293474807182,0.0299429986449,0.0307923351483,0.0354712091763,0.03562038077,0.0355347234901,0.0335353893926,0.0306499378606,0.0306423455078,0.029149284969,0.0184167625615,0.0175202860934,0.0176627277502,0.0174227266998,0.0173193851664,0.0169856097724,0.0169810906481,0.0163301672953,0.0153010139748,0.0159994483612,0.0175063469807,0.0182927634796,0.018150931455,0.0179920784118,0.0179215014752,0.0186560543815,0.0177779666014,0.0203259238024,0.0204038447463,0.021728315647,0.0217156666275,0.0222719502167,0.0225480275844,0.0224343229544,0.0235085424153,0.0239752985189,0.0246590876762,0.0242641523507,0.0225769713344,0.0182011168685,0.0176438241336,0.0173050330546,0.0159161002794,0.0153099605246,0.013509042304,0.0129323167885,0.0120073685524,0.0119729429972,0.0129385735022,0.0124829310258,0.0133495154313,0.0129476348875,0.0131666518225,0.0121624201592,0.011154399908,0.010968546753,0.0106790621242,0.0102650561369,0.0103042104934,0.010288010956,0.0101748463532,0.0102840976832);
t60=(0.0098922267827,0.140515412933,0.172163197002,0.174621551698,0.174621551698,0.718785622302,0.814613258605,0.137359524421,1.22188071348,0.349164741141,0.349164741141,0.197143252978,1.74551029889,1.74551029889,1.74551029889,0.330295206849,0.298078928886,0.121048892983,0.121048892983,0.321605289754,0.581888999203,0.581888999203,1.01824698596,0.0172869476078,0.0172627445628,0.0167925897496,0.718785622302,0.271589989347,0.531296769015,0.124752072014,0.126037367835,0.678857440537,0.0172386095044,0.0168154856406,0.0905822463244,0.0978225549736,0.0962832767358,0.0962832767358,0.0955316760376,0.0919432065767,0.0879778188202,0.092639152164,0.089916776793,0.0879778188202,0.0172869476078,0.0234846076979,0.0172869476078,0.0168154856406,0.0168154856406,0.0611684965187,0.134342356298,0.130057335639,0.124752072014,0.1328829652,0.124752072014,0.0172627445628,0.0172386095044,0.0172627445628,0.0173355588098,0.0172869476078,0.0173844454312,0.0231313082736,0.0172386095044,0.0172386095044,0.179755174754,0.179755174754,0.0319792539011,0.0820785284899,0.0149422580744,0.014924197761,0.012872246654,0.012832183246,0.012832183246,0.0127923699768,0.0126874064918,0.0128188844789,0.0128455098059,0.012832183246,0.0127923699768,0.0126614358698,0.0126614358698,0.0125331711977,0.0122357504464,0.00986079855377,0.00988435080759,0.0097294442437,0.00972182729389,0.00952792211019,0.00952061983489,0.00941956039122,0.00904264016749,0.00905581259858,0.00905581259858,0.00904922154722,0.00906241334291,0.00906241334291,0.0090690238016,0.00891301130746,0.00879950980277,0.00862863551674,0.643132225291,0.643132225291,0.00858103740442,0.00856332446489,0.131454958861,0.130057335639,0.135834178312,0.135834178312,0.134342356298,0.134342356298,0.222224238814,0.214429646696,0.24443882647,0.24443882647,0.24443882647,0.24443882647,0.235040347058,0.305528943153,0.284218437251,0.298078928886,0.321605289754,0.067210373342,0.067210373342,0.117559358926,0.118699950961,0.26568756262,0.26568756262,0.26568756262,0.124752072014,0.939926321566,0.0308542894159,0.0306234708313,0.0861207886704,0.100226100112,0.101895228693,0.210733934924,0.203712082574,0.190984975253,0.179755174754,0.0300245494419,0.0291689475528,0.0293081363689,0.0293081363689,0.0293081363689,0.0303210451726,0.0303210451726,0.0602656873902,0.0591026482779,0.102750832425,0.103620937917,0.103620937917,0.128689136067,0.135834178312,0.131454958861,0.124752072014,0.123492741768,0.123492741768,0.12225859813,0.0947917280661,0.0611684965187,0.0611684965187,0.0308542894159,0.0309320061128,0.0312468380463,0.0541404341589,0.0541404341589,0.0539022755086,0.0539022755086,0.0541404341589,0.0541404341589,0.0541404341589,0.0541404341589,0.0543807097766,0.0541404341589,0.0582594449382,0.0541404341589,0.0286252006205,0.177151163056,0.169773129941,0.165186785054,0.194015238893,0.13891953749,0.134342356298,0.106322048027,0.149078647077,0.194015238893,0.226338051331,0.194015238893,0.194015238893,0.194015238893,0.152803653959,0.149078647077,0.149078647077,0.149078647077,0.0254797218307,0.0255326410312,0.0255857811894,0.0255326410312,0.0254797218307,0.0254797218307,0.0254797218307,0.0255857811894,0.0256391436921,0.0745785164711,0.0745785164711,0.0262973576219,0.0799347341566,0.0794161865068,0.0779001777853,0.0764410194097,0.0745785164711,0.0256391436921,0.0254797218307,0.0254797218307,0.0255326410312,0.0254797218307,0.0254797218307,0.0254797218307,0.0254797218307,0.0194107664379,0.0253222762797,0.0254270222127,0.0254270222127,0.0254797218307,0.0255326410312,0.0255326410312,0.0255326410312,0.0255326410312,0.0254797218307,0.047992205691,0.053200225235,0.053200225235,0.053200225235,0.167448544174,0.167448544174,0.172163197002,0.203712082574,0.203712082574,0.203712082574,0.182436918149,0.172163197002,0.172163197002,0.165186785054,0.0536662059707,0.053200225235,0.053200225235,0.053200225235,0.0529702607182,0.0529702607182,0.0529702607182,0.0518496709334,0.0467120666791,0.047992205691,0.053200225235,0.0536662059707,0.0534321981769,0.053200225235,0.053200225235,0.0541404341589,0.053200225235,0.119862907549,0.119862907549,0.1328829652,0.1328829652,0.1328829652,0.137359524421,0.137359524421,0.142148401762,0.200373824908,0.210733934924,0.210733934924,0.137359524421,0.0534321981769,0.053200225235,0.0529702607182,0.047992205691,0.0468907396079,0.0413555012354,0.0409413501626,0.0255857811894,0.0255857811894,0.0409413501626,0.0264103699375,0.0412165212447,0.0409413501626,0.0409413501626,0.0256391436921,0.0254797218307,0.0254797218307,0.0254270222127,0.0194107664379,0.0194107664379,0.407345805406,0.290983677212,0.407345805406);

modeFreqs=par(i,nModes,ba.take(i+1, modeFrequencies));
modeGains=par(i,nModes,ba.take(i+1, massEigenValues));
modeT60 = par(i,nModes,ba.take(i+1,t60));

cabinetRandallExcelTreble=modalModel(nModes,modeFrequencies,modeT60,modeGains);

modalModel(n,modeFreqs,modeRes,modeGains) = _ <: par(i,n,gain(i)*pm.modeFilter(freqs(i),res(i))) :> _
with {
	freqs(i) = ba.take(i+1,modeFreqs);
	res(i) = ba.take(i+1,modeRes);
	gain(i) = ba.take(i+1,modeGains);
};


cab = cabinetRandallExcelTreble;

wetdry = vslider("[2] amount[style:knob]",  1, 0, 1, 0.01);
dry = 1 - wetdry;

process = _ <: _*dry, (_*wetdry:cab) :> _;
